<head>
  <title>Virtual Machines</title>
</head>

<body>
	<nav class="navbar navbar-default">
		<div class="container">
			<a class="navbar-brand" href="#">
				Virtual Machines <span>(For Code For Eau Claire)</span>
			</a>
		</div>
	</nav>
	<div class="container">
		{{> main}}
		{{> auth}}
		{{> otherResources}}
		{{> about}}
		<br />
	</div>
</body>


<template name="main">
	<h2>Your Virtual Machine</h2>
	{{#if ready}}
		{{> connect ip=ip}}
		{{> manage selfDestructTimeLeftHuman=selfDestructTimeLeftHuman}}
	{{/if}}
	{{#unless ready}}
		<span class="spin-container">
			{{> spinner}}
		</span>
		{{loadingStatus}}
	{{/unless}}
</template>

<template name="connect">
	<h3 id="connect">Connect</h3>
	<div class="panel panel-default">
		<div class="panel-body">
			<!-- Nav tabs -->
			<ul class="nav nav-tabs" role="tablist">
				<li role="presentation" class="active">
					<a href="#connectLinux" aria-controls="connectLinux"
						role="tab"
						data-toggle="tab">
						Linux / Mac OS
					</a>
				</li>
				<li role="presentation">
					<a href="#connectWindows" aria-controls="connectWindows"
						role="tab"
						data-toggle="tab">
						Windows
					</a>
				</li>
			</ul>

			<!-- Tab panes -->
			<div class="tab-content">
				<div role="tabpanel" class="tab-pane active" id="connectLinux">
					<br />
					<pre>ssh -i ~/.ssh/vms_id_rsa root@{{ip}}</pre>
				</div>
				<div role="tabpanel" class="tab-pane" id="connectWindows">
					<br />
					<p>1) Setup <a href="#auth">authentication</a> if you haven't yet.</p>
					<p>2) Run Putty, set host name to the following IP address</p>
					<pre>{{ip}}</pre>
					<p>3) When prompted for the user name, type in root</p>

					<br />
					<p><strong>Extra: How to transfer files</strong></p>
					<p>1) Start >> cmd</p>
					<p>2) Run this to copy a file to root's home directory</p>
					<pre>pscp source_file_name root@{{ip}}:/root/destination_file_name</pre>
				</div>
			</div>
		</div>
	</div>
</template>

<template name="manage">
	<h3>Manage</h3>
	<button class="btn btn-default">Give me a new machine</button> Machine will self destruct in about {{selfDestructTimeLeftHuman}}
</template>

<template name="auth">
	<h3 id="auth">Authenticate</h3>
	<div class="panel panel-default">
		<div class="panel-body">
			<!-- Nav tabs -->
			<ul class="nav nav-tabs" role="tablist">
				<li role="presentation" class="active">
					<a href="#linux" aria-controls="linux" role="tab" data-toggle="tab">
						Linux / Mac OS
					</a>
				</li>
				<li role="presentation">
					<a href="#windows" aria-controls="windows" role="tab" data-toggle="tab">
						Windows
					</a>
				</li>
			</ul>

			<!-- Tab panes -->
			<div class="tab-content">
				<div role="tabpanel" class="tab-pane active" id="linux">
					<br />
					<p>1) Save the private key</p>
					<pre>echo "{{privateKey}}" > ~/.ssh/vms_id_rsa</pre>
					<p>2) Set permissions</p>
					<pre>chmod 0600 ~/.ssh/vms_id_rsa</pre>
					<p>3) You're ready to <a href="#connect">Connect</a></p>
				</div>
				<div role="tabpanel" class="tab-pane" id="windows">
					<br />
					<p>1) <a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html">Download and install putty</a> (Full installer recomended)</p>
					<p>2) Copy the below into notepad and save as 'vms.ppk'</p>
					<pre>{{ppk}}</pre>
					<p>3) Start >> Pageant >> find in sys tray >> right click >> add key >> add vms.ppk</p>
					<p>4) You're ready to <a href="#connect">Connect</a></p>
				</div>
			</div>
		</div>
	</div>
</template>
<template name="otherResources">
	<h3>Other resources</h3>
	<p>If you're stuck authenticating or connecting <a target="_blank" href="https://www.digitalocean.com/community/tutorials/how-to-connect-to-your-droplet-with-ssh">How To Connect To Your Machine with SSH</a> may help.</p>
</template>

<template name="about">
	<h3>About</h3>
	<h4>How it works</h4>
	<p>All these servers are running with the same private/public key. We can help each other out easily this way by just sharing our server's ip with one another.</p>

	<h4>Known Issues</h4>
	<p>We can only run 10 machines at a time. It should be throttled, but this low number is a technical problem with Digital Ocean and not by choice.</p>

	<h4>Servers</h4>
	<p>Anthony is paying for these Virtual Machines and they aren't meant as permanent development environments.  Feel to use them for working on Code For Eau Claire for temporary needs, presentations, learning, testing, etc.</p>
	<p>It's pretty easy to spin up new virtual machines just like these for yourself that will stick around using <a href="https://www.digitalocean.com/">Digital Ocean</a>. They start at under $0.01 per hour.</p>
</template>
